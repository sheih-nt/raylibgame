# Лекция: Реализация Таймера в Игровом Коде с использованием Raylib

## Введение

В этой лекции мы рассмотрим, как реализовать таймер в игровой программе, используя библиотеку **raylib** для C++. Таймеры могут быть полезны в самых разных сценариях, например:
- Для ограничения времени на выполнение действий (например, ускорение персонажа на ограниченное время).
- Для создания временных событий (например, обратный отсчёт до конца раунда).
- Для реализации эффектов с ограничением по времени.

Мы сосредоточимся на механике таймера для ускорения объекта в игре. Когда игрок активирует ускорение, его скорость увеличивается на определённый период времени, и в это время будет отображаться обратный отсчёт.

## Основные Понятия

### 1. **Что такое таймер в контексте игр?**

Таймер в играх — это механизм, который отслеживает время и выполняет определённые действия по его истечении. В нашем случае таймер будет управлять временем, в течение которого объект в игре будет двигаться с увеличенной скоростью.

### 2. **Как работает таймер?**

- Таймер начинает отсчитывать время с момента активации.
- В течение определённого времени объект движется быстрее или выполняет какое-либо другое действие.
- Когда время заканчивается, объект возвращается к своему первоначальному состоянию.

В реализации игры таймер будет отсчитывать время до истечения ускорения. Как только ускорение завершится, таймер деактивируется, а скорость объекта возвращается к исходному значению.

---

## Механика Таймера

Для простоты примера представим, что у нас есть объект (квадрат), который движется по экрану с помощью клавиш **WASD**. Когда игрок нажимает клавишу **Q**, объект получает ускорение на 5 секунд.

### Структура Таймера

1. **Начало ускорения**:
    - Игрок нажимает клавишу **Q**, и объект начинает двигаться быстрее.
    - Таймер начинает отсчитывать время ускорения, например, на 5 секунд.
   
2. **Обратный отсчёт**:
    - На экране отображается текст, показывающий оставшееся время ускорения.
    - Как только время ускорения заканчивается, объект возвращается к обычной скорости.

### Как это работает в коде:

1. **Инициализация таймера**:
    - Мы устанавливаем переменные для времени, например, `boostTime`, которое будет отсчитывать время ускорения.
    - Переменная `boostDuration` определяет продолжительность ускорения в секундах.

2. **Активация ускорения**:
    - Когда игрок нажимает клавишу **Q**, ускорение активируется.
    - Мы увеличиваем скорость объекта и начинаем отсчёт времени с помощью `boostTime`.
   
3. **Отсчёт времени**:
    - Каждый кадр мы уменьшаем `boostTime` на величину, соответствующую времени, прошедшему с последнего кадра, с помощью функции `GetFrameTime()`.
    - Как только время заканчивается, ускорение деактивируется, и скорость объекта восстанавливается.

4. **Отображение таймера**:
    - Во время действия ускорения на экране будет отображаться текст с оставшимся временем.

---

## Реализация Таймера в Коде

Пример реализации таймера для ускорения объекта с использованием **raylib**:

```cpp
#include "raylib.h"

int main() {
    // Инициализация окна
    InitWindow(800, 600, "Raylib - Timer");
    SetTargetFPS(60);

    // Параметры объекта
    Vector2 position = {400, 300};
    float speed = 5.0f;  // обычная скорость
    bool isSpeedBoosted = false;
    float boostTime = 0.0f; // Время оставшееся до окончания ускорения
    float boostDuration = 5.0f; // Продолжительность ускорения (в секундах)

    // Главный игровой цикл
    while (!WindowShouldClose()) {
        // Логика таймера ускорения
        if (isSpeedBoosted) {
            boostTime -= GetFrameTime(); // Отнимаем время за один кадр
            if (boostTime <= 0.0f) {
                isSpeedBoosted = false; // Завершаем ускорение
                speed /= 1.5f; // Восстанавливаем обычную скорость
            }
        }

        // Обработка ввода
        if (IsKeyDown(KEY_W)) position.y -= speed;
        if (IsKeyDown(KEY_S)) position.y += speed;
        if (IsKeyDown(KEY_A)) position.x -= speed;
        if (IsKeyDown(KEY_D)) position.x += speed;

        // Ускорение при нажатии клавиши Q
        if (IsKeyPressed(KEY_Q) && !isSpeedBoosted) {
            speed *= 1.5f; // Увеличиваем скорость
            isSpeedBoosted = true; // Включаем ускорение
            boostTime = boostDuration; // Устанавливаем продолжительность ускорения
        }

        // Отрисовка
        BeginDrawing();
        ClearBackground(RAYWHITE);

        // Рисуем объект (квадрат)
        DrawRectangle(position.x, position.y, 50, 50, BLUE);

        // Отображаем таймер ускорения
        if (isSpeedBoosted) {
            DrawText(TextFormat("Speed Boost Active! Time left: %.1f", boostTime), 10, 10, 20, RED);
        }

        // Отображаем информацию
        DrawText("Use WASD to move, Q to boost speed for 5 seconds!", 10, 40, 20, BLACK);

        EndDrawing();
    }

    // Закрытие окна
    CloseWindow();

    return 0;
}
```

### Разбор Кода

1. **Инициализация переменных**:
    - `boostTime` отслеживает оставшееся время ускорения.
    - `boostDuration` — это продолжительность ускорения (5 секунд).

2. **Обработка нажатия клавиши**:
    - Когда игрок нажимает **Q**, увеличиваем скорость объекта и активируем ускорение.
    - Таймер начинает отсчитывать время с помощью `boostTime`, уменьшая его на `GetFrameTime()`.

3. **Отсчёт времени**:
    - Когда `boostTime` истекает (становится <= 0), ускорение заканчивается, и скорость восстанавливается.

4. **Отображение таймера**:
    - Пока ускорение активно, на экране будет отображаться текст с оставшимся временем.

---

## Полезные Функции для Таймеров в Raylib

- **`GetFrameTime()`**: Возвращает время, прошедшее с последнего кадра (в секундах). Это важно для плавного уменьшения времени в таймере.

- **`TextFormat()`**: Форматирует строки, позволяя вставлять динамические значения (например, остаток времени в таймере).


